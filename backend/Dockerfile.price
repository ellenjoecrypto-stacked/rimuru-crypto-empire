FROM python:3.11-slim

WORKDIR /app

# Install dependencies
RUN pip install --no-cache-dir \
    fastapi==0.109.0 \
    uvicorn==0.27.0 \
    aiohttp==3.9.1 \
    pydantic==2.5.3 \
    websockets==12.0

# Copy service code
COPY services/price_engine.py /app/services/price_engine.py
COPY api/price_service.py /app/api/price_service.py

# Create data directory
RUN mkdir -p /data

EXPOSE 8100

ENV PYTHONPATH=/app
ENV PRICE_SERVICE_PORT=8100

CMD ["python", "/app/api/price_service.py"]
